<apex:page title="{!$Label.pse__mass_update_rr_ui_mass_update_resource_requests_label}" standardController="pse__Resource_Request__c"
    extensions="pse.MassUpdateResourceRequestController" recordSetVar="resourceReqs" sidebar="false" lightningStylesheets="true">

    <style>
        #RRSkillAndCertOverlayContainer .secondaryPalette { background-color: transparent !important;}
    	.noWrap {white-space:nowrap;width:auto;}
        .pageBlockTableScroll {display: block; overflow-x: auto; width: 93vw;}
        .pageBlockTableScroll table th.headerRow + th.headerRow {border-left: 1px solid #dedede;}
        .requestedHourInput { width: {!IF($User.UIThemeDisplayed == 'Theme4d', '130px', '100px')}; }
        div.errorMsg { display: block !important; } /*Override for css rule against slds.css to resolve field error message distortion issue.*/ 
        div#RRSkillAndCertOverlay .pbBody{overflow: inherit;}
        div#rrSkilCertiOverlayPanel { overflow: auto !important; max-height: 510px; width: 614px;}
        #btnSpan { float: right; margin-top: 5px; margin-right: 10px;}
    </style>
    <apex:outputPanel rendered="{!$User.UIThemeDisplayed == 'Theme4d'}" layout="none">
		<style>
			.pageTitleIcon {
				border-radius: .25rem;
			    background-color: #f77e75;
			    background-image: url("{!URLFOR($Asset.SLDS, 'assets/icons/custom/custom15.svg')}");
			    background-repeat: no-repeat;
			    background-position: center;
			    background-size: 2rem;
				display: block !important;
			}
		</style>
	</apex:outputPanel>
    <!-- will see if only needed styles can be included -->
    <apex:stylesheet value="{!URLFOR($Resource.pse__jsComponentsResources, 'componentStyles.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.pse__yui3_1, 'YUIcombo_3_3_0.css')}" />
    
    <script src="{!$Resource.yui_combo}/yui-min.js" type="text/javascript"></script>
    <script src="{!$Resource.yui_combo}/loader-min.js" type="text/javascript"></script>
    <script src="{!$Resource.yui_combo}/combo.js" type="text/javascript"></script>
    <script src="{!$Resource.jsComponents}" type="text/javascript"></script>
    <apex:outputpanel id="headerPanel">
       <apex:sectionHeader title="{!$Label.pse__mass_update_rr_ui_mass_update_resource_requests_label}" subtitle="{!subTitle}" help="{!$Page.pse__MassUpdateResourceRequestHelp}" rendered="{!NOT(isRsponseSuccess)}"/>
       <apex:sectionHeader title="{!$Label.pse__mass_update_rr_ui_updated_resource_requests_label}" subtitle="{!subTitle}" help="{!$Page.pse__MassUpdateResourceRequestHelp}" rendered="{!isRsponseSuccess}"/>
    </apex:outputpanel>
    <c:selectAllCheckboxes functionName="selectAllResources" />
    <c:WaitComponent />
    <apex:actionStatus id="ajaxStatus" onstart="wait(true)" onstop="wait(false)" />
    
    <apex:form id="massUpdateRRForm">
        <apex:outputPanel id="massUpdRRResultPanel" rendered="{!isResultPage}">
            <apex:pageBlock id="rrUpdResultPB">
                <apex:pageBlockButtons >
                	<apex:commandButton value="{!$Label.pse__mass_update_rr_ui_create_new_resource_requests_button}"  status="ajaxStatus"
						action="{!addResourceRequests}" rendered="{!requestWrapperMap!=null && requestWrappers.size == 0}" />
                    <apex:commandButton value="{!$Label.pse__mass_update_rr_ui_back_to_mass_update_resource_request_button}" action="{!backToMassUpdateRR}" rendered="{!isRsponseSuccess}"/>
                    <apex:commandButton value="{!IF(isParentProject,$Label.pse__mass_update_rr_ui_back_to_project_button,$Label.pse__mass_update_rr_ui_back_to_opportunity_button)}"  
						action="{!backToParent}"  immediate="true"/>
                </apex:pageBlockButtons> 
                <apex:pageMessages id="resultMessageSection" />
                <apex:pageBlockSection columns="1" title="{!$Label.pse__mass_update_rr_ui_resource_request_details_label}" rendered="{!isRsponseSuccess && requestWrappers.size>0}" collapsible="false">
                    <apex:pageBlockTable value="{!requestWrappers}" var="rrId">
                        <apex:column value="{!requestWrapperMap[rrId].resourceRequest.Name}" style="{!IF(requestWrapperMap[rrId].isError,'color:red;','')}"/>
                        <apex:column value="{!requestWrapperMap[rrId].resourceRequest.Resource_Request_Name__c}" style="{!IF(requestWrapperMap[rrId].isError,'color:red;','')}"/>
                        <apex:column value="{!requestWrapperMap[rrId].resourceRequest.Resource_Role__c}" style="{!IF(requestWrapperMap[rrId].isError,'color:red;','')}"/>
                        <apex:column value="{!requestWrapperMap[rrId].resourceRequest.SOW_Hours__c}" style="{!IF(requestWrapperMap[rrId].isError,'color:red;','')}"/>
                        <apex:column value="{!requestWrapperMap[rrId].resourceRequest.Start_Date__c}" style="{!IF(requestWrapperMap[rrId].isError,'color:red;','')}"/>
                        <apex:column value="{!requestWrapperMap[rrId].resourceRequest.End_Date__c}" style="{!IF(requestWrapperMap[rrId].isError,'color:red;','')}"/>
                        <apex:column value="{!requestWrapperMap[rrId].resourceRequest.Status__c}" style="{!IF(requestWrapperMap[rrId].isError,'color:red;','')}"/>
                        <apex:column headerValue="{!$Label.pse__create_res_req_label_skils_certs}" >
                            <apex:outputText value="{!requestWrapperMap[rrId].skillsDescription}" style="{!IF(requestWrapperMap[rrId].isError,'color:red;','')}"/>
                        </apex:column>
                    </apex:pageBlockTable>
                </apex:pageBlockSection>    
            </apex:pageBlock>
        </apex:outputPanel>
        <apex:outputPanel id="massUpdRRPanel" rendered="{!NOT(isResultPage)}">
            <apex:pageBlock id="quickUpdRRPB">
                <apex:pageBlockButtons >
                    <apex:commandButton value="{!$Label.pse__mass_update_rr_ui_create_new_resource_requests_button}"  status="ajaxStatus"
						action="{!addResourceRequests}" reRender="messageSection,rrList" />
					<apex:commandButton value="{!$Label.pse__mass_update_rr_ui_delete_resource_requests_button}"  status="ajaxStatus" 
						action="{!deleteResourceRequests}" reRender="massUpdateRRForm" />                   
                    <apex:commandButton value="{!$Label.pse__mass_update_rr_ui_update_resource_requests_button}" status="ajaxStatus" id="updateResourceRequestsBtn" 
						action="{!massUpdateRR}" rerender="massUpdateRRForm,headerPanel" />
					<apex:commandButton value="{!IF(isParentProject,$Label.pse__mass_update_rr_ui_back_to_project_button,$Label.pse__mass_update_rr_ui_back_to_opportunity_button)}"  
						action="{!backToParent}"  immediate="true" />         
                </apex:pageBlockButtons>
                
                <apex:pageMessages id="messageSection" />
                <apex:actionRegion rendered="{!requestWrappers.size>0}">
                    <apex:pageBlockSection title="{!$Label.pse__mass_update_rr_ui_quick_update_resource_request_label}"
                                           id="resourceSelectorPBS" columns="1" collapsible="false">
                        <apex:pageBlockSectionItem >
                            {!$Label.pse__mass_update_rr_ui_quick_update_section_message}
                        </apex:pageBlockSectionItem>
                        <apex:outputPanel styleClass="pageBlockTableScroll">
                            <apex:pageBlockTable value="{!quickRRWrapper}" var="wrapper" id="quickUpdateTable">
                            
                                <apex:column headerValue="{!$ObjectType.pse__Resource_Request__c.fields.pse__Resource_Request_Name__c.label}">
                                    <apex:inputField value="{!wrapper.resourceRequest.pse__Resource_Request_Name__c}"
                                                 required="false"  />
                                </apex:column>
                            
                                <apex:column headerValue="{!$ObjectType.pse__Resource_Request__c.fields.pse__Resource_Role__c.label}">
                                    <apex:inputField value="{!wrapper.resourceRequest.pse__Resource_Role__c}"
                                                 required="false" />
                                </apex:column>
                            
                                <apex:column headerValue="{!$ObjectType.pse__Resource_Request__c.fields.pse__SOW_Hours__c.label}">
                                    <apex:inputField value="{!wrapper.resourceRequest.pse__SOW_Hours__c}"
                                                 required="false" styleClass="requestedHourInput"/>
                                </apex:column>
                            
                                <apex:column headerValue="{!$ObjectType.pse__Resource_Request__c.fields.pse__Start_Date__c.label}">
                                    <apex:inputField value="{!wrapper.resourceRequest.pse__Start_Date__c}"
                                                required="false" />
                                </apex:column>
                            
                                <apex:column headerValue="{!$ObjectType.pse__Resource_Request__c.fields.pse__End_Date__c.label}">
                                    <apex:inputField value="{!wrapper.resourceRequest.pse__End_Date__c}"
                                                 required="false" />
                                </apex:column>
                                <apex:column headerValue="{!$ObjectType.pse__Resource_Request__c.fields.pse__Status__c.label}">
                                    <apex:inputField value="{!wrapper.resourceRequest.pse__Status__c}"
                                                 required="false" />
                                </apex:column>
                            
                                <apex:repeat value="{!resourceRequestColumnsAfterFiltering}" var="f">
                                    <apex:column headerValue="{!f.label}">
                                        <apex:inputField value="{!wrapper.resourceRequest[f]}" required="false"/>
                                    </apex:column>
                                </apex:repeat>
                            
                                <apex:column headerValue="{!$Label.pse__mass_update_rr_ui_assign_skills_or_certi_link}">
                                    <apex:commandLink value="{!$Label.pse__mass_update_rr_ui_assign_skills_or_certi_link}" action="{!loadQuickSkillAndCertificates}" 
                                                    reRender="rrSkillOverlayForm" 
                                                    status="ajaxStatus" immediate="true" oncomplete="_RRSkillAndCertiPopupHandler.show(this);">
                                                    <apex:image id="addIcon" value="{!URLFOR($Resource.pse__appirioCommon, '/new.svg')}" width="15" height="15" style="vertical-align:middle; margin-left: 5px;" />
                                    </apex:commandLink>
                                </apex:column>
                            
                            </apex:pageBlockTable>
                        </apex:outputPanel>
                        <apex:outputPanel id="quickUpdateSkillTable">
                            <apex:pageBlockSection title="{!$Label.pse__create_res_req_label_requested_skills}" 
                                                   rendered="{!quickRRWrapper.skills.size>0}" 
                                                   collapsible="false"> 
                                <apex:pageBlockTable value="{!quickRRWrapper.skills}" var="reqSkill" >
                                    <apex:column value="{!reqSkill.pse__Is_Primary__c}"/>
                                    <apex:column value="{!reqSkill.pse__Skill_Certification__c}"/>
                                    <apex:column value="{!reqSkill.pse__Minimum_Rating__c}"/>
                                </apex:pageBlockTable>
                            </apex:pageBlockSection>
                        </apex:outputPanel>
                        <apex:commandButton value="{!$Label.pse__mass_update_rr_ui_quick_update_selected_button}"
                                            status="ajaxStatus"  reRender="rrList,resourceSelectorPBS, messageSection" action="{!quickUpdate}"
                                            id="quickUpdateButton"  />
                            
                    	   </apex:pageBlockSection>
                
                    <apex:pageBlockSection title="{!$Label.pse__mass_update_rr_ui_resource_request_details_label}" id="rrList" columns="1" collapsible="false">
                        <apex:outputPanel styleClass="pageBlockTableScroll">
                            <apex:pageBlockTable value="{!requestWrappers}" var="rrId">
                                <apex:column >
                                    <apex:facet name="header">
                                        <input type="checkbox" id="rrSelectorChkAllBox" onclick="selectAllResources(this, 'rrSelectorChkBox')" />
                                    </apex:facet>
                                    <apex:inputCheckbox value="{!requestWrapperMap[rrId].isSelected}" id="rrSelectorChkBox" />
                                </apex:column>
                                <apex:column value="{!requestWrapperMap[rrId].resourceRequest.Name}"/>
                                
                                <apex:column headerValue="{!$ObjectType.pse__Resource_Request__c.fields.pse__Resource_Request_Name__c.label}">
                                    <apex:inputField value="{!requestWrapperMap[rrId].resourceRequest.Resource_Request_Name__c}"  />
                                </apex:column>
                                <apex:column headerValue="{!$ObjectType.pse__Resource_Request__c.fields.pse__Resource_Role__c.label}" styleclass="noWrap">
                                    <div class="requiredInput">
	           	 					    <div id="requiredBlockDiv" class="requiredBlock" ></div>
                                        <apex:inputField value="{!requestWrapperMap[rrId].resourceRequest.Resource_Role__c}"/>
                                    </div>
                                </apex:column>
                                
                                <apex:column headerValue="{!$ObjectType.pse__Resource_Request__c.fields.pse__SOW_Hours__c.label}" styleclass="noWrap">
                                    <div class="requiredInput">
	           	 						<div id="requiredBlockDiv" class="requiredBlock" ></div>
                                        <apex:inputField value="{!requestWrapperMap[rrId].resourceRequest.SOW_Hours__c}" styleClass="requestedHourInput"/>
                                    </div>
                                </apex:column>
                                
                                <apex:column headerValue="{!$ObjectType.pse__Resource_Request__c.fields.pse__Start_Date__c.label}" styleclass="noWrap">
                                    <div class="requiredInput">
	           	 					    <div id="requiredBlockDiv" class="requiredBlock" ></div>
                                        <apex:inputField value="{!requestWrapperMap[rrId].resourceRequest.Start_Date__c}" required="false" />
                                    </div>
                                </apex:column>
                                
                                <apex:column headerValue="{!$ObjectType.pse__Resource_Request__c.fields.pse__End_Date__c.label}" styleclass="noWrap">
                                    <div class="requiredInput">
	           	 					    <div id="requiredBlockDiv" class="requiredBlock" ></div>
                                        <apex:inputField value="{!requestWrapperMap[rrId].resourceRequest.End_Date__c}" />
                                    </div>
                                </apex:column>
                                <apex:column headerValue="{!$ObjectType.pse__Resource_Request__c.fields.pse__Status__c.label}">
                                    <apex:inputField value="{!requestWrapperMap[rrId].resourceRequest.Status__c}"/>
                                </apex:column>
                                <apex:repeat value="{!resourceRequestColumnsAfterFiltering}" var="f">
                                    <apex:column headerValue="{!f.label}" styleclass="noWrap">
                                        <div class="{!IF(OR(f.required,f.DBRequired), 'requiredInput','')}">
                                            <div id="requiredBlockDiv" class="{!IF(OR(f.required,f.DBRequired), 'requiredBlock' , '')}" ></div>
                                            <apex:inputField value="{!requestWrapperMap[rrId].resourceRequest[f]}" />
                                        </div>
                                    </apex:column>
                                </apex:repeat>
                                <apex:column headerValue="{!$Label.pse__create_res_req_label_skils_certs}">
                                    <span id="SkillRequest{!rrId}">
                                        <apex:outputText value="{!requestWrapperMap[rrId].skillsDescription}" />
                                    </span>
                                    <apex:commandLink action="{!loadSkillAndCertificates}" 
                                                      reRender="rrSkillOverlayForm" 
                                                      immediate="true"  status="ajaxStatus" oncomplete="_RRSkillAndCertiPopupHandler.show(this);" >
                                                      <apex:image id="addIcon" value="{!URLFOR($Resource.pse__appirioCommon, '/edit.svg')}" width="15" height="15" style="vertical-align:middle;float:right"/>
                                        <apex:param name="currentRR" value="{!rrId}" 
                                                    assignTo="{!currentRR}"/>  
                                    </apex:commandLink>
                                </apex:column>
                            </apex:pageBlockTable>
                        </apex:outputPanel>
                    </apex:pageBlockSection>
                </apex:actionRegion>
            </apex:pageBlock>
        </apex:outputPanel>
        </apex:form>
        
    <div id="RRSkillAndCertOverlayContainer" class="overlayContainer">
        <div id="RRSkillAndCertOverlay">
            <div class="yui-widget-hd overlarCaptionBar" onclick="javascript:_RRSkillAndCertiPopupHandler.hide();"></div>
            <div class="yui-widget-bd overlayBody">
                <apex:form id="rrSkillOverlayForm">
                    <div id="rrSkilCertiOverlayPanel">
                        <apex:pageBlock >
                            <apex:outputPanel id="RRSkillsAndCertiPanel">
                                <apex:pageMessages id="lookupMsgSection" />
                                <apex:actionRegion id="addSkillRegion">
                                
                                    <apex:variable value="{!0}" var="rowNum"/>
                                    <apex:pageBlockSection title="{!$Label.pse__create_res_req_label_skills_and_certs}" columns="1" id="RRSkillSection"
                                                           collapsible="false">
                                        <apex:pageBlockTable value="{!resourceSkillRequestWrapperList}" var="eachRecord" id="RRSkillTable" rendered="{!renderRRSkills}" > 
                                          
                                              <apex:column headerValue="{!$ObjectType.pse__Resource_Skill_Request__c.fields.pse__Skill_Certification__c.label}" styleclass="noWrap">
                                                  <div class="requiredInput">
                                                      <div id="requiredBlockDiv" class="requiredBlock" ></div>
                                                      <apex:inputField value="{!eachRecord.skill.pse__Skill_Certification__c}" id="rrSkill" required="false" />
                                                  </div>
                                           	  </apex:column>
      
                                              <apex:column headerValue="{!$ObjectType.pse__Resource_Skill_Request__c.fields.pse__Minimum_Rating__c.label}">
                                                 <apex:inputField value="{!eachRecord.skill.pse__Minimum_Rating__c}"/>
                                               </apex:column>
                       
                                                <apex:column headerValue="{!$Label.pse__create_res_req_label_primary}">
                                                    <apex:inputHidden id="primarySkillHidden" value="{!eachRecord.skill.pse__Is_Primary__c}"/>
                                                    <apex:outputPanel rendered="{!eachRecord.skill.pse__Is_Primary__c}">
                                                        <input type="radio" name="primaryRadio" checked="true" onClick="updatePrimarySkillRadio('{!$Component.RRSkillTable}')" />
                                                        <script type="text/javascript">currentPrimarySkillHiddenId = "{!$Component.primarySkillHidden}";</script>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!NOT(eachRecord.skill.pse__Is_Primary__c)}">
                                                        <input type="radio" name="primaryRadio" onClick="updatePrimarySkillRadio('{!$Component.RRSkillTable}')"/>
                                                    </apex:outputPanel>
                                                </apex:column>
                                               
                                                <apex:column headerValue="{!$Label.pse__common_label_remove}">
                                                    <apex:commandLink style="float:centre;" action="{!DeleteRowFromSkillList}"  rerender="RRSkillsAndCertiPanel"  status="ajaxStatus" >
                                                       <apex:param value="{!eachRecord.counter}" name="selectedSkillToDelete" assignTo="{!delRRSkill}"/>
                                                       <apex:image id="deleteIcon" value="{!URLFOR($Resource.pse__appirioCommon, '/delete.svg')}" width="18" height="18" />  
                                                    </apex:commandLink>
                                                  </apex:column>
                                    </apex:pageBlockTable>
                                    </apex:pageBlockSection>                           
                                    <apex:commandLink action="{!addRowToSkillList}" 
                                                  reRender="RRSkillsAndCertiPanel" 
                                                  status="ajaxStatus" >
                                                  <apex:image id="addIcon" value="{!URLFOR($Resource.pse__appirioCommon, '/new.svg')}" width="15" height="15" style="vertical-align:middle;"/>  
                                    </apex:commandLink>
                                    {!$Label.pse__mass_update_rr_ui_add_more_row_link}
                                    </apex:actionRegion>
                                                            
                            </apex:outputPanel>
                        </apex:pageBlock>
                    </div>
                    <span id="btnSpan">
                    		<apex:commandButton value="{!$Label.pse__common_label_cancel}" action="{!cancelSkillUpdate}"
                         	immediate="true" oncomplete="javascript:_RRSkillAndCertiPopupHandler.hide();" />
                    		<apex:commandButton value="{!$Label.pse__common_label_done}"  rendered="{!renderRRSkills}"
                                                        reRender="quickUpdateSkillTable, lookupMsgSection" action="{!updateRRSkill}"
                                                        status="ajaxStatus"  id="updRRskillBtn" 
                                                        oncomplete="updateSkillAndCertification('{!isQuickUpdate}','{!currentRR}','{!currentSkillDescription}','{!isSkillUpdate}');" />
                    	</span>
                </apex:form>  
            </div>
        </div>
    </div>
                                           
    <script type="text/javascript">
        var _yui;
        var isLightningMode = {!$User.UIThemeDisplayed == 'Theme4d'};
        var _Label = {
            name : "{!JSINHTMLENCODE($Label.common_label_name)}",
            noResultsFound : "{!JSINHTMLENCODE($Label.timecard_entry_label_no_matching_results_found)}"
        }
            
        /////////////////////////////////////////////////////////////////////////////////////////
        //---------------------------SkillAndCert Lookup Handler STARTS------------------------//
        /////////////////////////////////////////////////////////////////////////////////////////   
        
        var _RRSkillAndCertiPopupHandler = {
            
            overlay : null,
            overlayContainer : null,
            overlayEscKeyHandle : null,
            lastSearchString : null,
        
            prepare : function(){
                _RRSkillAndCertiPopupHandler.overlay = new _yui.Overlay({
                    contentBox : "#RRSkillAndCertOverlay" ,
                    width : "100%",
                    zindex : 5  
                });
                
                /* Center overlay in viewport */
                _RRSkillAndCertiPopupHandler.overlay.set("centred" , true);
                _RRSkillAndCertiPopupHandler.overlay.render();
                _RRSkillAndCertiPopupHandler.overlay.show();
        
                _RRSkillAndCertiPopupHandler.overlayContainer = _yui.one("#RRSkillAndCertOverlayContainer");
            },
        
            attachEscKey : function(){
                _RRSkillAndCertiPopupHandler.overlayEscKeyHandle = _yui.on('key' , _RRSkillAndCertiPopupHandler.hide , document , 'down:27' , _yui);
            },
        
            detachEscKey : function(){
                _RRSkillAndCertiPopupHandler.overlayEscKeyHandle.detach();
            },
        
            show : function(){
                //#TODO see if we need this
                validateZIndexForOverlay(true);
                
                //@TODO FIXME: This makes overlay open slow
                _RRSkillAndCertiPopupHandler.overlayContainer.setStyle('display','block');
                if(isLightningMode){
			        _RRSkillAndCertiPopupHandler.overlayContainer.setStyle('height',document.body.scrollHeight + 'px');
		        }
                _RRSkillAndCertiPopupHandler.overlay.set('centred','true');
                stablizeOverlay(_RRSkillAndCertiPopupHandler.overlay);
                _RRSkillAndCertiPopupHandler.attachEscKey();
                
            },
        
            hide : function(){
                _RRSkillAndCertiPopupHandler.overlayContainer.setStyle('display','none');
                _RRSkillAndCertiPopupHandler.detachEscKey();
        
                validateZIndexForOverlay(false);
            }
        }
        
        window.onresize = function onresize() {
            if(isLightningMode)
            {
                _RRSkillAndCertiPopupHandler.overlayContainer.setStyle('height',document.body.scrollHeight + 'px');
            }
        }
        //////////////////////////////////////////////////////////////////////////////////////////////////
        //-----------------------------_SkillAndCert Lookup Handler ENDS--------------------------------//
        //////////////////////////////////////////////////////////////////////////////////////////////////  
        
        YUI({fetchCSS : false}).use("node","event","event-key", "io",  "overlay", "anim", "node-event-simulate", function(Y) {
            /*Recent release of Chrome (V7) have broken the UI. 
              This is because YUI's NODE creation API is failing while creating some specific type of NODE. 
              The cause of broken functionality is the YUI code [Y.Node.create()] which creates THEAD/TR/TD. 
              In latest chrome release any call to Y.Node.create() which creates THEAD/TR/TD without TABLE tag fails.*/
            Y.mix(Y.DOM.creators, {
                tbody: function(html, doc) {
                    return Y.DOM.create('<table>' + html + '</table>', doc);
                },
                thead: function(html, doc) {
                    return Y.DOM.create('<table>' + html + '</table>', doc);
                },
                tr: function(html, doc) {
                    return Y.DOM.create('<tbody>' + html + '</tbody>', doc);
                },
                td: function(html, doc) {
                    return Y.DOM.create('<tr>' + html + '</tr>', doc);
                }, 
                th: function(html, doc) {
                    return Y.DOM.create('<tr>' + html + '</tr>', doc);
                }
                
            });
            
            _yui = Y;
            _RRSkillAndCertiPopupHandler.prepare();
        }); 
   
    var currentPrimarySkillHiddenId = null;
    var defaultNoPrimarySkill = "{!defaultNoPrimarySkill}";
    function updatePrimarySkillRadio(tableId) {
        var newHiddenId = tableId + ":primarySkillHidden";
        tableId += "";
        var rowNo = tableId.substring(tableId.lastIndexOf(":")+1);
        var primarySkillRadio = document.getElementsByName("primaryRadio");
        if (defaultNoPrimarySkill == 'true') {
            var hiddenElement = document.getElementById(newHiddenId);
            if (hiddenElement.value == 'true') {
                hiddenElement.value = "false";
                primarySkillRadio[rowNo].checked = false;
            } else {
                hiddenElement.value = "true";
                primarySkillRadio[rowNo].checked = true;
            }
        } else {
            document.getElementById(newHiddenId).value = "true";
        }
        if (currentPrimarySkillHiddenId != newHiddenId && 
            document.getElementById(currentPrimarySkillHiddenId) != null)
            document.getElementById(currentPrimarySkillHiddenId).value = "false";
        
        currentPrimarySkillHiddenId = newHiddenId;
    } 
       
    function updateSkillAndCertification(isQuickUpd,currentRR,currentSkillDescription,isSkillUpdate){
        if(isSkillUpdate != 'false'){
	        if(isQuickUpd != 'true'){
	            document.getElementById("SkillRequest"+currentRR).innerHTML = currentSkillDescription ;
	        }
            _RRSkillAndCertiPopupHandler.hide();
        }
    }
    </script>   
</apex:page>