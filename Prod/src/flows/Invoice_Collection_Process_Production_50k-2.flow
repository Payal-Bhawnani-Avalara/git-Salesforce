<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <decisions>
        <name>FoundBillingContact</name>
        <label>FoundBillingContact</label>
        <locationX>605</locationX>
        <locationY>416</locationY>
        <defaultConnector>
            <targetReference>FindCaseContact_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>NoBillingContact</defaultConnectorLabel>
        <rules>
            <name>FoundBilling</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varCollectionsCaseContact</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>CreateCollectionCase</targetReference>
            </connector>
            <label>FoundBillingContact</label>
        </rules>
    </decisions>
    <decisions>
        <name>FoundPrimaryContact_0</name>
        <label>FoundPrimaryContact</label>
        <locationX>615</locationX>
        <locationY>549</locationY>
        <defaultConnector>
            <targetReference>FindCaseContact_0_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>NoPrimary</defaultConnectorLabel>
        <rules>
            <name>Foundprimary_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>varCollectionsCaseContact</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>CreateCollectionCase</targetReference>
            </connector>
            <label>FoundPrimary</label>
        </rules>
    </decisions>
    <interviewLabel>Invoice Collection Process Production - 50k {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Invoice Collection Process Production - 50k</label>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_Invoice_Assignment</name>
        <label>Create Invoice Assignment</label>
        <locationX>1225</locationX>
        <locationY>414</locationY>
        <connector>
            <targetReference>Update_Collection_Log_0</targetReference>
        </connector>
        <inputAssignments>
            <field>AssignedCase__c</field>
            <value>
                <elementReference>varCollectionCase</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Assigned_Invoice__c</field>
            <value>
                <elementReference>varInvoiceIDnative</elementReference>
            </value>
        </inputAssignments>
        <object>Invoice_Assignment__c</object>
    </recordCreates>
    <recordCreates>
        <name>CreateCollectionCase</name>
        <label>CreateCollectionCase</label>
        <locationX>990</locationX>
        <locationY>420</locationY>
        <assignRecordIdToReference>varCollectionCase</assignRecordIdToReference>
        <connector>
            <targetReference>Create_Invoice_Assignment</targetReference>
        </connector>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>varAccountID_fromInv</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ContactId</field>
            <value>
                <elementReference>varCollectionsCaseContact</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Description</field>
            <value>
                <elementReference>Description</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Invoice_Due_Date__c</field>
            <value>
                <elementReference>varInvoiceDueDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Origin</field>
            <value>
                <stringValue>ICP Automation</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <stringValue>00G0b000002esbYEAQ</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <stringValue>01233000000MImiAAG</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <elementReference>CaseSubject</elementReference>
            </value>
        </inputAssignments>
        <object>Case</object>
    </recordCreates>
    <recordLookups>
        <name>FindBillingContact00</name>
        <label>FindBillingContact</label>
        <locationX>604</locationX>
        <locationY>271</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>FoundBillingContact</targetReference>
        </connector>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varAccountID_fromInv</elementReference>
            </value>
        </filters>
        <filters>
            <field>BillingContact__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Email</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <object>Contact</object>
        <outputAssignments>
            <assignToReference>varCollectionsCaseContact</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>FindCaseContact_0</name>
        <label>FindCaseContact</label>
        <locationX>230</locationX>
        <locationY>419</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>FoundPrimaryContact_0</targetReference>
        </connector>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varAccountID_fromInv</elementReference>
            </value>
        </filters>
        <filters>
            <field>Email</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>PrimaryContact__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <object>Contact</object>
        <outputAssignments>
            <assignToReference>varCollectionsCaseContact</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>FindCaseContact_0_0</name>
        <label>FindCaseContact</label>
        <locationX>616</locationX>
        <locationY>740</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>CreateCollectionCase</targetReference>
        </connector>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varAccountID_fromInv</elementReference>
            </value>
        </filters>
        <object>Contact</object>
        <outputAssignments>
            <assignToReference>varCollectionsCaseContact</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>GetCMDates</name>
        <label>Get Dates and Vars</label>
        <locationX>600</locationX>
        <locationY>7</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>UpdateStartProcess</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varInvoiceIDnative</elementReference>
            </value>
        </filters>
        <object>Zuora__ZInvoice__c</object>
        <outputAssignments>
            <assignToReference>varCM01Wait</assignToReference>
            <field>CM01_Date__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varCM02Wait</assignToReference>
            <field>CM02_Date__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varCM03Wait</assignToReference>
            <field>CM03_Date__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varCM04Wait</assignToReference>
            <field>CM04_Date__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varCM05Wait</assignToReference>
            <field>CM05_Date__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varCM06Wait</assignToReference>
            <field>CM06_Date__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varCM07Wait</assignToReference>
            <field>CM07_Date__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varCM08Wait</assignToReference>
            <field>CM08_Date__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varCM09Wait</assignToReference>
            <field>CM09_Date__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varCM10Wait</assignToReference>
            <field>CM10_Date__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varDueAge</assignToReference>
            <field>Due_Age__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varInvoiceDueDate</assignToReference>
            <field>Due_Date_ICP__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varInvoiceNumber</assignToReference>
            <field>Name</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varAccountID_fromInv</assignToReference>
            <field>Zuora__Account__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>varInvoiceBalance</assignToReference>
            <field>Zuora__Balance2__c</field>
        </outputAssignments>
    </recordLookups>
    <recordUpdates>
        <name>Update_Collection_Log_0</name>
        <label>Update Collection Log</label>
        <locationX>1228</locationX>
        <locationY>747</locationY>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varInvoiceIDnative</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>ICP_Status__c</field>
            <value>
                <stringValue>50K Case Created</stringValue>
            </value>
        </inputAssignments>
        <object>Zuora__ZInvoice__c</object>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateStartProcess</name>
        <label>Start 50k</label>
        <locationX>603</locationX>
        <locationY>124</locationY>
        <connector>
            <targetReference>FindBillingContact00</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varInvoiceIDnative</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>ICP_Status__c</field>
            <value>
                <stringValue>50K ICP</stringValue>
            </value>
        </inputAssignments>
        <object>Zuora__ZInvoice__c</object>
    </recordUpdates>
    <startElementReference>GetCMDates</startElementReference>
    <textTemplates>
        <name>CaseSubject</name>
        <text>50K Pre-Collection Case for {!varInvoiceNumber}</text>
    </textTemplates>
    <textTemplates>
        <name>CM01Log</name>
        <text>{!$Flow.CurrentDateTime}  CM01 DD -15 Days
{!varRecentCollectionLog}</text>
    </textTemplates>
    <textTemplates>
        <name>CM02Log</name>
        <text>{!$Flow.CurrentDateTime}  CM02 DD + 01 Day
{!varRecentCollectionLog}</text>
    </textTemplates>
    <textTemplates>
        <name>CM03Log</name>
        <text>{!$Flow.CurrentDateTime}  CM03 DD +5 Days
{!varRecentCollectionLog}</text>
    </textTemplates>
    <textTemplates>
        <name>CM04Log</name>
        <text>{!$Flow.CurrentDateTime}  CM04 DD + 31 Days
{!varRecentCollectionLog}</text>
    </textTemplates>
    <textTemplates>
        <name>CM05Log</name>
        <text>{!$Flow.CurrentDateTime} CM05 DD + 45 Days
{!varRecentCollectionLog}</text>
    </textTemplates>
    <textTemplates>
        <name>CM06Log</name>
        <text>{!$Flow.CurrentDateTime} CM06 DD + 50 Days
{!varRecentCollectionLog}</text>
    </textTemplates>
    <textTemplates>
        <name>CM07Log</name>
        <text>{!$Flow.CurrentDateTime} CM07 DD + 61 Days
{!varRecentCollectionLog}</text>
    </textTemplates>
    <textTemplates>
        <name>CM08Log</name>
        <text>{!$Flow.CurrentDateTime} CM08 DD + 75 Days
{!varRecentCollectionLog}</text>
    </textTemplates>
    <textTemplates>
        <name>CM09Log</name>
        <text>{!$Flow.CurrentDateTime} CM09 DD + 91 Days
{!varRecentCollectionLog}</text>
    </textTemplates>
    <textTemplates>
        <name>CM10Log</name>
        <text>{!$Flow.CurrentDateTime} CM10 DD + 95 Days
{!varRecentCollectionLog}</text>
    </textTemplates>
    <textTemplates>
        <name>Description</name>
        <text>50K Pre-Collection Case due {!varInvoiceDueDate}</text>
    </textTemplates>
    <textTemplates>
        <name>PaidonReceiptLog</name>
        <text>{!$Flow.CurrentDateTime} Invoice Paid, ICP Stop</text>
    </textTemplates>
    <variables>
        <name>FoundCollectionCases</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>Case</objectType>
    </variables>
    <variables>
        <name>varAccountID_fromInv</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varCAMID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varCM01Wait</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varCM02Wait</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varCM03Wait</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varCM04Wait</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varCM05Wait</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varCM06Wait</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varCM07Wait</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varCM08Wait</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varCM09Wait</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varCM10Wait</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varCollectionCase</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varCollectionsCaseContact</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varDueAge</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <scale>4</scale>
    </variables>
    <variables>
        <name>varEmailforReminder</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varICPRisk</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varICPstop</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varInvoiceBalance</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>varInvoiceDueDate</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varInvoiceID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varInvoiceIDnative</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varInvoiceNumber</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>varRecentCollectionLog</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
</Flow>
